<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.springboot.dao.ItemDao">

	<insert id="insertItem" parameterType="Item" useGeneratedKeys="true" keyProperty="id">
		insert into item values(null, #{no}, #{path1}, #{path2}, #{remark1}, #{remark2}, #{manhole.id})
	</insert>

	<update id="updateItem" parameterType="Item">
		update item set no = #{no},
			path1 = #{path1},
			path2 = #{path2},
			remark1 = #{remark1},
			remark2 = #{remark2},
			manholeid = #{manhole.id}
		where id = #{id}
	</update>

	<delete id="deleteItem" parameterType="Item">
		delete from item where id = #{id}
	</delete>

	<select id="findInfoItem" parameterType="Map" resultType="Item">
		select i.* from item i left join manhole m on m.id = i.manholeid left join users u on u.id = m.userid
		<where>
			<if test="id != null">
				and i.id = #{id}
			</if>
			<if test="user != null">
				and u.id = #{user.id}
			</if>
		</where>
	</select>
	
	<select id="findListItem" parameterType="Map" resultType="Item">
		select * from item
		<where>
			<if test="manhole != null">
				manholeid = #{manhole.id}
			</if>
		</where>
		order by no
	</select>
	
</mapper>
 